---
title: "AI_dictator"
author: "Taito Hirano"
date: "2025-01-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## データの可視化

```{r load_libraries}
# 必要なライブラリを読み込む
library(ggplot2)
```

```{r load_and_process_data}
# CSVデータを読み込む
data <- read.csv("Table.csv")

# Is_Training 列を論理型に変換
data$Is_Training <- as.logical(data$Is_Training)

# NA がある場合の処理
data$Is_Training[is.na(data$Is_Training)] <- FALSE

# 線のデータを準備
data_lines <- data.frame(
  Game = data$Game,
  X_Dictator = data$Option_X_Dictator,
  X_Receiver = data$Option_X_Receiver,
  Y_Dictator = data$Option_Y_Dictator,
  Y_Receiver = data$Option_Y_Receiver,
  Is_Training = data$Is_Training
)

# 線の種類を設定
data_lines$Line_Type <- ifelse(data_lines$Is_Training, "solid", "dotted")
```

```{r create_plot, fig.width=12, fig.height=12}
# プロット作成
ggplot() +
  # 線を描画
  geom_segment(
    data = data_lines,
    aes(
      x = X_Dictator, y = X_Receiver,
      xend = Y_Dictator, yend = Y_Receiver,
      linetype = Line_Type
    ),
    color = "black"
  ) +
  # Option X のポイントを描画
  geom_point(
    data = data_lines,
    aes(x = X_Dictator, y = X_Receiver),
    color = "blue", size = 4, shape = 15
  ) +
  # Option X の横にゲーム番号を表示
  geom_text(
    data = data_lines,
    aes(x = X_Dictator, y = X_Receiver, label = Game),
    nudge_x = 20, nudge_y = 20,
    size = 4
  ) +
  # Option Y のポイントを描画
  geom_point(
    data = data_lines,
    aes(x = Y_Dictator, y = Y_Receiver),
    color = "red", size = 4, shape = 16
  ) +
  # Option Y の横にゲーム番号を表示
  geom_text(
    data = data_lines,
    aes(x = Y_Dictator, y = Y_Receiver, label = Game),
    nudge_x = 20, nudge_y = 20,
    size = 4
  ) +
  # ラベルとテーマ設定
  labs(
    x = "Dictator's Payoff",
    y = "Receiver's Payoff",
    title = "Payoff Scenarios in the Dictator Game",
    linetype = "Line Type (Is_Training)"
  ) +
  # linetype の凡例設定
  scale_linetype_manual(
    values = c("solid" = "solid", "dotted" = "dotted"),
    labels = c("solid" = "Training (TRUE)", "dotted" = "Not Training (FALSE)")
  ) +
  # 縦横比を1:1に固定
  coord_fixed(ratio = 1) +
  # グラフの表示範囲を調整
  scale_x_continuous(limits = c(0, 1100)) +
  scale_y_continuous(limits = c(0, 1100)) +
  theme_minimal() +
  theme(
    legend.title = element_text(size = 12),
    legend.text = element_text(size = 11),
    axis.title = element_text(size = 14),
    axis.text = element_text(size = 12),
    plot.title = element_text(size = 16),
    aspect.ratio = 1,
    plot.margin = margin(30, 30, 30, 30, "pt")
  )
```
